---
eip: 1193
title: Ethereum Provider JavaScript API
author: Fabian Vogelsteller (@frozeman), Ryan Ghods (@ryanio), Victor Maia (@MaiaVictor), Marc Garreau (@marcgarreau)
discussions-to: https://github.com/ethereum/EIPs/issues/2319
status: Draft
type: Standards Track
category: Interface
created: 2018-06-30
requires: 155, 695, 1102, 1474, 1767
---

## Summary

This EIP formalizes a JavaScript Ethereum Provider API for consistency across clients and applications.

The provider is intended to be available on `window.ethereum` so JavaScript dapps can be written once and function in perpetuity.

The provider's interface is designed to be minimal, preferring for features to be introduced in the API layer (e.g. see [`eth_requestAccounts`](https://eips.ethereum.org/EIPS/eip-1102)), and agnostic of any particular transport protocol.

The events `connect`, `close`, `chainChanged`, and `accountsChanged` are provided to enable reactive dapp UIs.

## API

### Send

Ethereum API methods can be sent and received through the `send` method.

```js
ethereum.send(method: String, params?: Array<any> | Object): Promise<any>;
```

If present, `params` for the request can be provided as a structured value, either by-position as an `Array` or by-name as an `Object`.

Promise resolves with `data` or rejects with `Error`.

#### Transports

Multiple transports may be available.

[EIP 1474](https://eips.ethereum.org/EIPS/eip-1474) specifies the Ethereum JSON-RPC API.

[EIP 1767](https://eips.ethereum.org/EIPS/eip-1767) specifies the Ethereum GraphQL schema.

### Events

Events are emitted using [EventEmitter](https://nodejs.org/api/events.html).

#### notification

The provider may emit notifications on the `EventEmitter` key `notification`, such as JSON-RPC notifications and GraphQL subscriptions.

Some clients like [Geth](https://geth.ethereum.org/docs/rpc/pubsub) and [Parity](https://wiki.parity.io/JSONRPC-eth_pubsub-module) support Publish-Subscribe (_Pub-Sub_) using JSON-RPC notifications. This lets you subscribe and wait for events instead of polling for them.

Attach listeners with:

```js
ethereum.on('notification', listener: (result: any) => void): this;
```

To create a JSON-RPC subscription, send `ethereum.send('eth_subscribe', yourParams)` or `ethereum.send('shh_subscribe', yourParams)`. See the [eth subscription methods](https://geth.ethereum.org/docs/rpc/pubsub) and [shh subscription methods](https://github.com/ethereum/go-ethereum/wiki/Whisper-v6-RPC-API#shh_subscribe).

#### connect

The provider emits `connect` on connect to a network.

```js
ethereum.on('connect', listener: () => void): this;
```

You can detect which chain by sending `eth_chainId`:

```js
const chainId = await ethereum.send('eth_chainId');
> 1
```

#### close

The provider emits `close` on disconnect from a network.

```js
ethereum.on('close', listener: (code: Number, reason: String) => void): this;
```

The event emits with `code` and `reason`. The code follows the table of [`CloseEvent` status codes](https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#Status_codes).

#### chainChanged

The provider emits `chainChanged` on connect to a new chain.

```js
ethereum.on('chainChanged', listener: (chainId: Integer) => void): this;
```

The event emits with integer `chainId`, the new chain returned from `eth_chainId`.

The event `networkChanged` is deprecated in favor of `chainChanged`. For more info, see [EIP 155: Simple replay attack protection](https://eips.ethereum.org/EIPS/eip-155) and [EIP 695: Create eth_chainId method for JSON-RPC](https://eips.ethereum.org/EIPS/eip-695).

#### accountsChanged

The provider emits `accountsChanged` if the accounts returned from the provider (`eth_accounts`) changes.

```js
ethereum.on('accountsChanged', listener: (accounts: Array<String>) => void): this;
```

The event emits with `accounts`, an array of the accounts' addresses.

## Examples

```js
const ethereum = window.ethereum;

// A) Set provider in web3.js
let web3 = new Web3(ethereum);
// web3.eth.getBlock('latest', true).then(...)

// B) Use provider object directly
// Example 1: Log last block
ethereum
  .send('eth_getBlockByNumber', ['latest', 'true'])
  .then(block => {
    console.log(`Block ${block.number}:`, block);
  })
  .catch(error => {
    console.error(
      `Error fetching last block: ${error.message}.
       Code: ${error.code}. Data: ${error.data}`
    );
  });

// Example 2: Log available accounts
ethereum
  .send('eth_accounts')
  .then(accounts => {
    console.log(`Accounts:\n${accounts.join('\n')}`);
  })
  .catch(error => {
    console.error(
      `Error fetching accounts: ${error.message}.
    Code: ${error.code}. Data: ${error.data}`
    );
  });

// Example 3: Log new blocks
let subId;
ethereum
  .send('eth_subscribe', ['newHeads'])
  .then(subscriptionId => {
    subId = subscriptionId;
    ethereum.on('notification', result => {
      if (result.subscription === subscriptionId) {
        if (result.result instanceof Error) {
          const error = result.result;
          console.error(
            `Error from newHeads subscription: ${error.message}.
             Code: ${error.code}. Data: ${error.data}`
          );
        } else {
          const block = result.result;
          console.log(`New block ${block.number}:`, block);
        }
      }
    });
  })
  .catch(error => {
    console.error(
      `Error making newHeads subscription: ${error.message}.
       Code: ${error.code}. Data: ${error.data}`
    );
  });

// Example 4: Log when accounts change
const logAccounts = accounts => {
  console.log(`Accounts:\n${accounts.join('\n')}`);
};
ethereum.on('accountsChanged', logAccounts);
// to unsubscribe
ethereum.removeListener('accountsChanged', logAccounts);

// Example 5: Log if connection ends
ethereum.on('close', (code, reason) => {
  console.log(`Ethereum provider connection closed: ${reason}. Code: ${code}`);
});
```

## Specification

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [RFC-2119](https://www.ietf.org/rfc/rfc2119.txt).

### Send

The `send` method **MUST** send a properly formatted request to the underlying client.

If present `params` for the request **MUST** be provided as a structured value, either by-position through an `Array` or by-name through an `Object`.

If the request is successful, the provider **MUST** resolve the promise with the response `result` without any underlying JSON-RPC or GraphQL structure.

### Errors

If the request returns an error then the Promise **MUST** reject with an `Error` object containing the `error.message` as the Error message, `error.code` as a code property on the error and `error.data` as a data property on the error.

If an error occurs during processing, such as an HTTP error or internal parsing error, then the Promise **MUST** reject with an `Error` object.

#### Error object and codes

If an `Error` object is returned, it **MUST** contain a human readable string message describing the error and **SHOULD** populate the `code` and `data` properties on the error object with additional error details.

Error codes **SHOULD** follow the table of [error codes listed in EIP 1474](https://github.com/ethereum/EIPs/blob/master/EIPS/eip-1474.md#error-codes).

### Events

The provider **SHOULD** extend from `EventEmitter` to provide dapps flexibility in listening to events. In place of full `EventEmitter` functionality, the provider **MAY** provide as many methods as it can reasonably provide, but **MUST** provide at least `on`, `emit`, and `removeListener`.

#### notification

All subscriptions or notifications received from the client **MUST** emit on the `EventEmitter` key `notification`.

#### connect

If the network connects, the Ethereum Provider **MUST** emit an event named `connect`.

#### close

If the network connection closes, the Ethereum Provider **MUST** emit an event named `close` with args `code: Number, reason: String` following the [status codes for `CloseEvent`](https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#Status_codes).

#### chainChanged

If the chain the provider is connected to changes, the provider **MUST** emit an event named `chainChanged` with args `chainId: Integer` containing the ID of the new chain (using the Ethereum JSON-RPC call `eth_chainId`).

#### accountsChanged

If the accounts connected to the Ethereum Provider change at any time, the Ethereum Provider **MUST** send an event with the name `accountsChanged` with args `accounts: Array<String>` containing the accounts' addresses.

## References

- [Initial discussion in `ethereum/interfaces`](https://github.com/ethereum/interfaces/issues/16)
- [Initial Ethereum Magicians thread introducing the EIP](https://ethereum-magicians.org/t/eip-1193-ethereum-provider-javascript-api/640)
- [Continuing EIP-1193 discussion](https://github.com/ethereum/EIPs/issues/2319)

## Copyright

Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).
