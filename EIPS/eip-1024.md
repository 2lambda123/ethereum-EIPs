---
eip: 1024
title: Add web3.eth.encrypt
author: Tope Alabi <alabitemitope@gmail.com>
status: Draft
type: Interface Track
created: 2018-05-14
---

### Summary
...

### Abstract
This EIP proposes a cross-client method for requesting encryption/decryption. This method will include a version parameter, so that different encryption methods can be added under the same name. 
 
Parity wallet already implements this and the MetaMask version is on the way. Having a cross-client standard will enable a whole new wave of decentralized applications that will allow users to securely store their private data in public databases such as IPFS.

### Motivation
Imagine an illegal immigrant named Martha. Martha moved to the United States illegally but then had 2 children there, so her children are citizens. One day Martha gets arrested and deported but her children get to stay. How will Martha pass power of Attorney, bank account info, identification docs, and other sensitive information to her children? Storing that data in a centralized database can be incriminating for Martha, so maybe decentralized databases like IPFS could help, but if the data is not encrypted anyone can see it. If Martha had access to a Dapp that could encrypt her data in a way that’ is connected to her identity and save it in a decentralized database, Martha’s children will experience less suffering. 
More casually, Martha can store her nickname in a secure way or create a treasure hunt game, etc.

### Specification
```
/**
* Returns user's public Encryption key
*/
web3.eth.getPublicEncryptionKey(account) { /* implementation */ }

/**
* Encrypts plain data.
* @param {Account} account - The account to encrypt with
* @param {string} version - A unique string identifying the encryption strategy.
* @param {Object} data - The data to encrypt
* @param {Function} callback - The function to call back when decryption is complete.
*/
web3.eth.encrypt = function encrypt (account, version, data, callback) { /* implementation */ }
web3.eth.encrypt(account, 'x25519-xsalsa20-poly1305-v1', data, callback)

/**
* Decrypts some encrypted data.
* @param {Account} account - The account to decrypt with
* @param {string} version - A unique string identifying the decryption strategy.
* @param {Object} data - The data to decrypt
* @param {Function} callback - The function to call back when decryption is complete.
*/
web3.eth.decrypt = function decrypt (account, version, data, callback) { /* implementation */ }
web3.eth.decrypt(account, 'x25519-xsalsa20-poly1305-v1', data, callback)

```

### Rationale
These methods should require user confirmation. We include the versioning to allow differnet encryption/decryption types to be added under the same method name. For example, it might make sense to have a few kinds of decrypt methods, for different kinds of consent:
- Consent to download a decrypted file.
- Consent to return decrypted file to the current site.
- Consent to return any number of decrypted messages to the current site over a certain period of time. (could enable chat apps)


### Backwards Compatibility
This solution is compatible with existing Parity implementation.

### Test Cases
`getPublicEncryptionKey(account)` should return a public encryption key of the form `"C5YMNdqE4kLgxQhJO1MfuQcHP5hjVSXzamzd/TxlR0U="`

`web3.eth.encrypt(account, 'x25519-xsalsa20-poly1305-v1', 'data', callback)` should return a blob of the form `{ 
  ethereumPrivateKey: '7e5374ec2ef0d91761a6e72fdf8f6ac665519bfdf6da0a2329cf0d804514b816',
  encryptionPrivateKey: 'flN07C7w2Rdhpucv349qxmVRm/322gojKc8NgEUUuBY=',
  encryptionPublicKey: 'C5YMNdqE4kLgxQhJO1MfuQcHP5hjVSXzamzd/TxlR0U=' }` 

`web3.eth.decrypt(account, 'x25519-xsalsa20-poly1305-v1', 'data', callback)` should return plain text/file of the form `{ data:'My name is Satoshi Buterin' }` 

### Implementation
Parity wallet has already implemented a compatible encryption/decryption method. Metamask is currently building one.
https://github.com/paritytech/parity/blob/bd7273061e3f13f53fdd2fa91dc641a83bcc47f0/ethcore/crypto/src/lib.rs#L211
https://github.com/topealabi/eth-sig-util/blob/master/index.js
