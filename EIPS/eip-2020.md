---
eip: 2020
title: Ethereum Provider
author: Ryan Ghods (@ryanio), Marc Garreau (@marcgarreau)
discussions-to: https://ethereum-magicians.org/t/eip-2020-ethereum-provider/640
status: Draft
type: Standards Track
category: Interface
created: 2018-06-30
---

## Summary

This proposal formalizes an Ethereum Provider API.

For privacy and security, the request will not return if the user does not grant permission (see [EIP 1102](https://github.com/ethereum/EIPs/blob/master/EIPS/eip-1102.md)).

## Use

```js
window.addEventListener('message', function(event) {
  if (event.data && event.data.type === 'REQUEST_ETHEREUM_PROVIDER') {
    start(event.data.ethereum);
  }
});
window.postMessage({ type: 'REQUEST_ETHEREUM_PROVIDER' });

function start(ethereum) {
  // Log latest block number
  ethereum.send('eth_blockNumber', [], console.log);

  // Set provider in web3.js
  web3.setProvider(ethereum);
}
```

## Ethereum Provider API

```js
// JSON-RPC requests
ethereum.send(method, params, callback(result, error));

// EventEmitter
ethereum.on('connect', handler(message));
ethereum.on('end', handler(message));

// Subscriptions
const subscriptionType = 'newBlockHeaders';
ethereum.on(subscriptionType, handler(message));

// Class
ethereum.constructor.name;
> 'EthereumProvider'

// Meta provider information
ethereum.info;
> {
  connection: 'websocket',
  network: 'ropsten',
  networkId: 3,
  jsonRPCVersion: '2.0',
  swarm: 'http://localhost:8500',
  whisper: true
};
```

## Topics

### Multiple chain support

As per discussion in [ethereum/interfaces#16](https://github.com/ethereum/interfaces/issues/16), to handle support of changing networks we recommend introducing a new RPC method `eth_changeNetwork`. In the future depending on the implementation of sharding, an additional method could be `eth_changeShard`.

### Against polluting the global namespace

Previously, web3 clients have injected their own web3 libraries into the global namespace. This leads to issues like outdated libraries and breaking changes. We can supply the provider along with the return event of the postMessage request and prevent polluting the global namespace, with the benefit of protecting against fingerprinting attacks (see [EIP 1102](https://github.com/ethereum/EIPs/blob/master/EIPS/eip-1102.md)). Apps should version their own web3 library, then simply set the provider after receiving it (e.g. `web3.setProvider()`).

## Copyright

Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).
