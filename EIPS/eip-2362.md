---
eip: 2362
title: Pull Oracle Interface
author: Alliance of Decentralized Oracles (l.loya.b@gmail.com)
discussions-to: https://github.com/ethereum/EIPs/issues/2379
status: Draft
type: Standards Track
category: ERC
created: 2019-11-06
---

## Simple Summary

A standard interface for numeric pull oracles.

## Abstract

In order for ethereum smart contracts to interact with off-chain systems, oracles must be used. These oracles report values which are normally off-chain, allowing smart contracts to react to the state of off-chain systems. A standard interface for oracles is described here, allowing different oracle implementations to be interchangeable and lead to increased security for customers.  

## Motivation

As the value held by smart contracts that rely on off-chain data to execute grows, the security of oracles systems and the ability of these to be interchangeable and implemented in groups will grow in importance. 

The Ethereum ecosystem currently has many different oracle implementations available, but they do not provide a unified interface. Smart contract systems would be locked into a single set of oracle implementations, or they would require developers to write adapters/ports specific to the oracle system chosen in a given project.


## Background
[EIP-1154](https://eips.ethereum.org/EIPS/eip-1154), for standardizing an oracle interface, was not widely adopted and abandoned as too early and specificaly too broad/general to provide any efficiency gains. This new proposal is a cooperation between current oracle systems and direct users of these. The specification below reflects this collaboration and addresses the main reason why [EIP-1154](https://eips.ethereum.org/EIPS/eip-1154) was not successful.

Link:  https://eips.ethereum.org/EIPS/eip-1154

#### [EIP-1154](https://eips.ethereum.org/EIPS/eip-1154) summary:
[EIP-1154](https://eips.ethereum.org/EIPS/eip-1154) prescribed two functions for pulling(resultFor) and pushing(receiveResult) data where the customer would pull data or the oracle provider would push data to the customer contract. Both functions specified inputs and results as bytes data (bytes32 and bytes) and had a conversion cost associated with them that was deemed insignificant through testing within the EIP discussion. More information available here: 

Proposal: https://eips.ethereum.org/EIPS/eip-1154
Discussion: https://github.com/ethereum/EIPs/issues/1161
 
[EIP-1154](https://eips.ethereum.org/EIPS/eip-1154) Conclusion: Standard not adopted
“It seems wasteful to specify something only to force proprietary interpretions of data on oracles anyway, and have silly things like putting ABI encoded stuff in data only to unwrap it and reinterpret it before putting it in a different format. At that point, just have the proprietary endpoint and use plain function calls.” Alan Lu (https://github.com/ethereum/EIPs/issues/1161#issuecomment-512535316) 
 

## Specification

In general there are two different types of oracles, push and pull oracles. Where push oracles are expected to send back a response to the consumer and pull oracles allow consumers to pull or call/read the data onto their own systems. This specification is for pull based oracles only.


Definitions


<dl>
<dt>Oracle</dt>
<dd>An entity which reports data to the blockchain and it can be any Ethereum account.</dd>
<dt>Oracle consumer</dt>
<dd>A smart contract which receives or reads data from an oracle.</dd>
<dt>ID</dt>
<dd>A way of indexing the data which an oracle reports. May be derived from or tied to a question for which the data provides the answer.</dd>
<dt>Value</dt>
<dd>Data associated with an id which is reported by an oracle. This data oftentimes will be the answer to a question tied to the id. Other equivalent terms that have been used include: result, answer, data, outcome.</dd>
</dl>



### Pull-based Interface

The pull-based interface specs:

```solidity
interface IERC2362
{
	function valueFor(bytes32 _id) external view returns(int256 _value,uint256 _timestamp,uint256 _statusCode);
}
```

- `valueFor` MUST return a status code of 404 if the value for an `id` is not available yet.
- Once a value is first available for an `id`, `valueFor` MUST return the value, along the timestamp representing when such value was set.
- May the value associated to an `id` be updated, `valueFor` MUST return the newest available value, along the timestamp representing when such update took place.

#### Inputs

##### `bytes32 id`

A standard descriptor of the data point we are querying a value for.

It is up to the implementor of an EIP-2362 compliant contract to decide which `id`s to support, i.e. for which `id`s will `valueFor` return a value and timestamp at some point, and for which it will always revert.

These `id`s MUST however be uniform across all providers: multiple EIP-2362 compliant contracts can give different values and timestamps for the same `id`, but they must be referring to the same data point.
	
Proposed Id generation fields: 
A complete list is kept on Google doc [here](https://docs.google.com/spreadsheets/d/15TPUuPWrxh7eMGaJKIupOh6l5yG-abn8UJejVhHCWV8/edit?usp=sharing).

| Description | ValuePair | DecimalPlaces | String           | Keccak256                                                        |
|-------------|-----------|---------------|------------------|------------------------------------------------------------------|
| Price       | ETH/USD   | 3             | Price-ETH/USD-3  | dfaa6f747f0f012e8f2069d6ecacff25f5cdf0258702051747439949737fc0b5 |
| Price       | BTC/USD   | 3            | Price-BTC/USD-3 | 637b7efb6b620736c247aaa282f3898914c0bef6c12faff0d3fe9d4bea783020 |



#### Outputs

##### `uint timestamp`

Timestamp (in the Unix format as used by the EVM) associated to the returned value.

It is up to the implementor of an EIP-2362 compliant contract to set the associated timestamp to one of these:
   - the timestamp of the block in which the returned value was last mutated (by invoking `block.timestamp` or `now()` at the updating transaction).
   - an oracle-specific timestamp that offers a more precise metric of when the reported value was actually probed.

##### `int value`

Latest value available for the requested `id`.

To accommodate for decimal values (which are common in prices and rates) this is expected to be multiplied by a power of ten such as `10**9` or `10**18`.
The specific power of ten MUST explicitly be stated by the `id` used as input.

##### `uint status`

Describes the value's status. For consistency, the status codes will correspond to the codes used for [HTTP](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes) status codes 

Status codes: 
* 200 OK
* 400 Bad Request
* 404 Not Found



## Rationale
Currently deployed contracts require oracles and individual companies to build specific adapters for each implementation. Future builds by both oracle adapters and new companies can create a world where oracles are interchangeable.  Diversity in oracle technology paired with oracle implementations being interchangeable can drastically increase security of oracle consumers since attacks on oracles can be minimized by projects utilizing multiple oracles in their design (averages, medians, etc.). 


#### Multiple Oracle Consumers

Oracle consumers can choose as many oracles as they wish and mix and match the types based on their needs (e.i. Average value from several oracles e.g. Compound’s and Maker’s open oracle designs).



#### Result Immutability

In the proposed specifications, oracle consumers determine when results are immutable once they use the value to execute and finalize a transaction. However, the use of multiple oracles and a dispute period is highly recommended for the oracle consumers to increase security since finality of a value can be affected by an oracle attack but as with any attack on chain, it becomes extremely expensive to attack over time and eventually “good/correct” values will make it on-chain. 


## Implementation

* [Tidbit](https://github.com/levelkdev/tidbit) tracks this EIP.


## Copyright

Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).






