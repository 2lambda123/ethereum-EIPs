---
eip: 999
title: Restore Contract Code at 0x863DF6BFa4469f3ead0bE8f9F2AAE51c91A907b4
author: Afri Schoedon (@5chdn)
discussions-to: https://ethereum-magicians.org/t/o-be-announced/999
status: Draft
type: Standard Track
category: Core
created: 2018-04-04
---

## Simple Summary
This document proposes to restore the contract code of the `WalletLibrary`
contract at `0x863DF6BFa4469f3ead0bE8f9F2AAE51c91A907b4` with a patched version.
The contract was accidentally self-destructed and renders a significant amount
of Ether inaccessible.

## Abstract
The `WalletLibrary` contract was used by the Parity Wallet to reduce gas costs
for users deploying multi-signature wallets on the Ethereum blockchain. It
contained basic functionality such as confirming or revoking multi-signature
transactions for any wallet deployed that depends on this library. The
[accidental self-destruction](https://github.com/paritytech/parity/issues/6995)
of the library contract caused significant amounts of Ether and other assets
owned by many different parties to be inaccessible. This proposal suggests
restoring the `WalletLibrary` by a fully tested and
[peer-reviewed](https://github.com/parity-contracts/0x863df6bfa4) version to
allow the owners of the dependent multi-signature wallets regain access to their
assets.

## Motivation
This proposal is necessary because the Ethereum protocol does not allow the
restoration of self-destructed contracts and there is no other simple way to
enable the affected users and companies regaining access to their tokens and
Ether. In opposite to previously discussed proposals, this will not change any
EVM semantics and tries to achieve the goal of unfreezing the funds by a single
state transition as specified in the next section.

## Specification

### High-level Overview

The self-destructed contract code at
[`0x863DF6BFa4469f3ead0bE8f9F2AAE51c91A907b4`](https://etherscan.io/address/0x863df6bfa4469f3ead0be8f9f2aae51c91a907b4#code)
shall be replaced with a patched version of the
[`walletLibrary.sol`](https://github.com/parity-contracts/0x863df6bfa4/blob/master/contracts/walletLibrary.sol)
as reviewed, tested, and approved in
[parity-contracts/0x863df6bfa4](https://github.com/parity-contracts/0x863df6bfa4):

```
{
  "linkReferences": {},
  "object": "@TODO",
  "opcodes": "@TODO",
  "sourceMap": "@TODO"
}
```

To verify the byte-code above, a patched version is deployed at
[`@TODO`](https://etherscan.io/address/@TODO#code)
to be reviewed. The compiler settings used can be extracted from the following
meta-data:

```
@TODO
```

### Direct State Transition

At `CNSTNTNPL_FORK_BLKNUM`, directly recreate the account
`0x863DF6BFa4469f3ead0bE8f9F2AAE51c91A907b4` with the following parameters:

* Balance: (_unchanged_)
* Nonce: `0x1`
* Code:

```
@TODO
```

* Storage values:
  * `0x0000000000000000000000000000000000000000000000000000000000000000`: `@TODO`
  * `0x0000000000000000000000000000000000000000000000000000000000000001`: `@TODO`
  * `0x0000000000000000000000000000000000000000000000000000000000000107`: `@TODO`
  * `0x565a22c1af7fcc038f06206699a6bd0ad8c85d23dafe9aebac3e0df68e8fb320`: `@TODO`

## Rationale
The design decision to restore the `WalletLibrary` contract code in a single
state transition was made after lengthy discussions of
[alternate proposals](https://gist.github.com/5chdn/a9bb8617cc8523a030126a3d1c60baf3)
that explored different ways to improve the Ethereum protocol to allow contract
revivals by adding different built-in contracts. It was eventually concluded
that all of these proposals changing the EVM semantics around self-destructed
contracts were introducing unwanted side-effects and potential risks to the
existing smart-contract ecosystem on the Ethereum platform.

It is assumed that this change is aligned with the interests both of (A) Parity
Technologies that intended to provide a smart-contracts library for
multi-signature wallets to last forever for its users and (B) the users of the
multi-signature wallets that meant to safely store their assets in a contract
accessible any time they desire. Lastly, the client-side implementation cost of
this proposal is estimated to be low. A sample implementation will be attached
and linked in the following sections.

## Backwards Compatibility
This proposal introduces backwards incompatibilities in the state of the
contract at `0x863DF6BFa4469f3ead0bE8f9F2AAE51c91A907b4`. The Ethereum protocol
does not allow the restoration of self-destructed contracts. To implement this
on the Ethereum blockchain, it is recommended to add the necessary state
transition in a future hard-fork at a well-defined block number, e.g,
`CNSTNTNPL_FORK_BLKNUM` for the Constantinople milestone which is the next
scheduled hard-fork on the Ethereum road-map.

## Test Cases
[@TODO](https://github.com/parity-contracts/0x863df6bfa4)

## Implementation
A proof-of-concept implementation is available for the Parity client on branch
[`a5-eip999-poc`](https://github.com/paritytech/parity/compare/a5-eip999-poc). A
sample chain configuration for Parity can be found at the same branch in
[`multisig_test.json`](https://github.com/paritytech/parity/blob/ec054db1d478b867217a624df9998b331d523921/ethcore/res/ethereum/multisig_test.json#L38-L51)
describing the state change as specified above.

## Copyright
Copyright and related rights waived via
[CC0](https://creativecommons.org/publicdomain/zero/1.0/).
