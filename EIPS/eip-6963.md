---
eip: 6963
title: Multi Injected Provider Interface (aka MIPI)
description: Using window events to announce injected providers
author: Pedro Gomes (@pedrouid), Kosala Hemachandra (@kvhnuke), Richard Moore (@ricmoo), Gregory Markou (@GregTheGreek), Kyle Den Hartog (@kdenhartog), Glitch (@glitch-txs), Sam Wilson (@SamWilsn), Micah Zoltu (@MicahZoltu)
discussions-to: https://ethereum-magicians.org/t/eip-6963-multi-injected-provider-interface-aka-mipi/14076
status: Draft
type: Standards Track
category: Interface
created: 2023-05-01
requires: 1193
---

## Abstract

A Javascript communication protocol that enables multiple wallet providers to interface with an EVM-based application using a browser extension injected script through window events.

## Motivation

Currently, wallet providers that offer browser extensions must inject their Ethereum providers ([EIP-1193](./eip-1193.md)) into the same window object `window.ethereum` however this creates conflicts for users that may install more than one browser extension.

Browser extensions are loaded in the web page and do not have a predictable pattern resulting in a race condition where the user is not in control to choose which wallet provider must be selected for exposing Ehtereum interface under the `window.ethereum` object.

This results not only in a degraded user experience but also increases the barrier to entry for new browser extensions as users are forced to only install one browser extension at a time.

Some browser extensions attempt to counteract this problem by delaying their injection to overwrite the same `window.ethereum` object which creates an unfair competition for wallet providers and lack of interoperability.

In this proposal, we provide a solution that optimitizes for interoperability of multiple wallet providers and enables fairer competition by lowering the barrier to entry for new wallet providers to improve the user experience on Ethereum.

This is achieved by introducing a set of window events to provide a two-way communication protocol between Ethereum libraries and injected scripts provided by browser extensions thus enabling users to select their wallet of choice.

## Specification

The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in RFC 2119.

### Provider Info

Each wallet provider will be exposed with the following interface `EIP6963ProviderInfo` that will be used to display to the user:

```typescript
/**
 * Represents the assets needed to display a wallet
 */
interface EIP6963ProviderInfo {
  walletId: string;
  uuid: string;
  name: string;
  icon: string;
}
```

The values in the `EIP6963ProviderInfo` MUST be used as follows:

- walletId - globally unique identifier of the wallet provider (eg. `io.dopewallet.extension` or `awesomewallet`)
- uuid - locally unique of the wallet provider (UUIDv4 compliant)
- name - human-readable name of the wallet provider (e.g. `DopeWalletExtension` or `AwesomeWallet`)
- icon - uri encoded image (RFC-3986 complaint / image must be squared with 96x96px minimum resolution)

### Announced Provider

The wallet provider will also expose their own [EIP-1193](./eip-1193.md) provider interface in parallel with the provider info provided above in the following interface `EIP6963AnnouncedProvider`

```typescript
interface EIP6963AnnouncedProvider {
  info: EIP6963ProviderInfo;
  provider: EIP1193Provider;
}
```

The `EIP1193Provider` interface is documented at [EIP-1193](./eip-1193.md) and can be used to override the `window.ethereum` object once the user as explicitly selected it.

### Window Event

Different wallet providers might inject their scripts at different timeframes plus there is no guarantees that the Ethereum library in the web page will be loaded before all injected scripts are present in the page.

To emit events it must use `window.dispatchEvent` and to observe events it must use `window.addEventListener`. There will be two event interfaces:

```typescript
// Requesting an EVM provider
interface EIP6963RequestProviderEvent extends Event {
  type: "eip6963:requestProvider";
}

// Annoucing an EVM provider
interface EIP6963AnnounceProviderEvent extends CustomEvent {
  type: "eip6963:announceProvider";
  detail: EIP6963AnnouncedProvider;
}
```

Therefore both Wallet providers and the Ethereum library must emit events when they initialize.

```typescript
// Ethereum library initializes
window.dispatchEvent(new Event("eip6963:requestProvider"));

// Wallet provider initializes
window.dispatchEvent(
  new CustomEvent("eip6963:announceProvider", { detail: provider })
);
```

Additionally the Wallet providers will react to the event emitted by the Ethereum library.

```typescript
window.addEventListener("eip6963:requestProvider", () => {
  window.dispatchEvent(
    new CustomEvent("eip6963:announceProvider", { detail: provider })
  );
});
```

## Rationale

### Interfaces

Standardizing a provider info interface (`EIP6963ProviderInfo`) allows determining the necessary information to populate a wallet selection popup. This is particularly useful for web3 onboarding libraries such as Web3Modal, RainbowKit, Web3Onboard, ConnectKit, etc.

Regarding the announced provider interface (`EIP6963AnnouncedProvider`) it was important to leave the [EIP-1193](./eip-1193.md) provider interface untouched for backwards-compatiblity therefore it's exposed in parallel.

### Identifiers

A locally unique identifier prevents from conflicts using the same globally unique identifier by using UUID v4.0

A globally unique identifier is used to for machine-readable detection of which wallet is being used and it can take different formats, for example:

```sh
# lowercase name
awesomewallet

# legacy JS variable
isCoolWallet

# reserved domain
io.dopewallet.app
```

### Images/Icons

A uri encoded image was chosen to enable flexibility for multiple protocols for fetching and rendering icons, for example:

```sh
# svg (data uri)
data:image/svg+xml,<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 32 32"><circle fill="red" cx="16" cy="16" r="12"/></svg>
# png (data uri)
data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==
# png (ipfs uri)
ipfs://QmZo7gsostaUdrV1peFz4cX6Z2TgriFJJP4VahG5knVm29
# webp (http uri)
https://ethereum.org/static/f541df14fca86543040c113725b5bd1a/99bcf/metamask.webp
```

Additionally the image must be squared with 96x96px minimum resolution. Image format is recommended to be lossless like PNG or WebP or alternatively vectorial like SVG. We strongly disencourage lossy formats like JPG/JPEG.

### Events

Previous proposal introduced mechanisms that relied on a single window object that could be overriden by multiple parties.

Therefore using an event-based approach we avoid these race conditions and potential attacks by making the communication available both ways.

To follow Javascript event name conventions the names are written in present tense and are prefixed with the standard number (`eip6963`).

## Backwards Compatibility

This EIP doesn't require supplanting `window.ethereum`, so it doesn't directly break existing applications. However, the recommended behavior of eventually supplanting `window.ethereum` would break existing applications that rely on it.

## Reference Implementation

### Wallet Provider

Here is a reference implementation for an injected script by a wallet provider to support this new interface in parallel with the existing pattern.

```typescript
function onPageLoad() {
  let provider: EIP1193Provider

  window.ethereum = provider

  function announceProvider() {
    const info: EIP6963ProviderInfo = {
      walletId: "org.example.wallet"
      uuid: "350670db-19fa-4704-a166-e52e178b59d2
      name: "Example Wallet"
      icon: "https://wallet.example.org/icon.png"
    }
    const data = { info, provider }
    window.dispatchEvent(new CustomEvent("eip6963:announceProvider", { detail: data }))
  }

  window.addEventListener("eip6963:requestProvider", (event: EIP6963RequestProviderEvent) => {
    announceProvider()
  })

  announceProvider()
}
```

### Ethereum library

Here is a reference implementation for a Ethereum library to display and track multiple wallet providers that are injected by browser extensions.

```typescript
function onPageLoad() {
  const providers: EVMProvider[] = [];

  window.addEventListener(
    "eip6963:announceProvider",
    (event: EIP6963AnnounceProviderEvent) => {
      providers.push(event.detail);
    }
  );

  window.dispatchEvent(new Event("eip6963:requestProvider"));
}
```

## Security Considerations

The security considerations of [EIP-1193](./eip-1193.md) apply to this EIP.

The use of SVG images introduces a cross-site scripting risk as they can include JavaScript code. Applications and libraries must render SVG images using the `<img>` tag to ensure no JS executions can happen.

## Copyright

Copyright and related rights waived via [CC0](../LICENSE.md).
