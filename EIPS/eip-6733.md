---
eip: 6733
title: Revert creation in case of collision
description: Revert contract creation if address already has code
author: Renan Rodrigues de Souza (@RenanSouza2)
discussions-to: https://ethereum-magicians.org/t/eip-revert-on-address-collision/13442
status: Draft
type: Standards Track
category: Core
created: 2023-03-20
---

## Abstract

There is no current definition to what happens when a contract creation happens in an address with code already deployed. This fix prevents an attack of deploying contract code and later changing the code arbitrarily.

## Motivation

In [EIP-3607](./eip-3607.md) it was estimated to require 10 billion USD in computing power to create an address collision. This number decreases as computers become more efficient over time.

## Specification

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119 and RFC 8174.

If a previously-existing account in the state trie would have its code modified by the the `CREATE` or `CREATE2` opcodes, or by transferring ether to the address ∅ (contract deploy from EOA), instead, the call or ether transfer MUST revert. The `CREATE` and `CREATE2` opcodes MUST cost an additional `100` gas.

## Rationale

One of the core tenants of smart contracts is that its code will not change. However with sufficient computing power an attacker can change the code stored in an address to any other code, steal funds or execute other malicious activity.

## Backwards Compatibility

This is an execution layer upgrade, and so it requires a hard fork.

## Test Cases

Given a genesis allocation of

```
Address : 0xd0bBEc6D2c628b7e2E6D5556daA14a5181b604C5,
Balance : 1000000000000000000, // 1 ether
Nonce   : 0,
code    : "",

Address : 0x5FbDB2315678afecb367f032d93F642f64180aa3,
Balance : 0,
Nonce   : 1,
Code    : "0xB0B0FACE",
```

A contract created in the first transaction from EOA `0xd0bBEc6...` (`227bcc6959669226360814723ed739f1214201584b6a27409dfb8228b8be5f59`), with no salt, should revert.


## Reference Implementation

The following check MUST be included in the function create function, MUST revert in case the check fails.

```
// During the execution of the create function Λ, defined in the yellow paper
// after computing the address of the new contract 'a'

a ≡ ADDR(s, σ[s]n − 1, ζ, i)

require(σ[a]c != EMPTYCODEHASH)
```

## Security Considerations

This EIP is a security upgrade: it reinforces the imutability of a deployed code.

## Copyright

Copyright and related rights waived via [CC0](../LICENSE.md).
