---
eip: 7085
title: NFT Relationship Enhancement
description: An enhancement proposal to establish relationships between NFTs and setting quantifiable attributes for those relationships.
author: Guang (@xg1990)
discussions-to: https://ethereum-magicians.org/t/introducing-new-eip-nft-relationship-standard/14468
status: Draft
type: Standards Track
category: ERC
created: 2023-05-02
---


## Abstract

This Ethereum Improvement Proposal (EIP) proposes a standard for referring relationships and quantifiable attributes between non-isolated [ERC-721](./eip-721.md) or [ERC-1155](./eip-1155.md) non-fungible tokens (NFTs). The proposed standard builds upon the existing ERC-1155 standard and extends it to enable users to build a graph of NFTs and quantify the relationships and attributes between them. The intended audience for this EIP is users who need to manage non-isolated NFTs and wish to build relationships between them while quantifying such relationships. Implementing this EIP would allow users to create a graph of NFTs and set quantifiable attributes for each NFT, enabling the creation of more complex NFT ecosystems. Careful design of rules may be required to avoid excessive complexity and gas cost. While a similar EIP, [ERC-5521](./eip-5521.md), exists for [ERC-721](./eip-721.md) tokens, it does not provide a way to establish quantifiable relationships or object attributes. This EIP would be a valuable enhancement to the NFT ecosystem, providing users with a powerful tool for managing and quantifying relationships between NFTs.

## Motivation

The current standard for NFTs lacks the ability to establish relationships and attributes between tokens. This limitation makes it difficult for users to build more complex NFT ecosystems that require referring relationships and quantifiable attributes between tokens. For example, a user may create a derivative NFT that refers to the original NFT and sets a quantifiable attribute for the relationship between the two NFTs, but without a standardized way to establish relationships and attributes between NFTs, managing these ecosystems becomes increasingly difficult and inefficient.

Our proposed EIP aims to address this issue by extending the [ERC-721](./eip-721.md) and [ERC-1155](./eip-1155.md) standards to include the ability to establish referring relationships and quantifiable attributes between NFTs. With this enhancement, users can create a graph of NFTs and set quantifiable attributes for each NFT, providing a powerful tool for managing and quantifying relationships between NFTs.

By enabling users to build more complex NFT ecosystems, our proposed EIP will enhance the NFT ecosystem and open up new possibilities for NFT use cases. However, it's important to consider potential drawbacks such as increased complexity and gas cost, and carefully design rules to mitigate these issues.

Our proposed EIP builds upon the existing Ethereum ecosystem and extends the standard for NFTs.

## Specification

This EIP proposes the addition of two new functions to the [ERC-721](./eip-721.md) and [ERC-1155](./eip-1155.md) standard: `setRelationship` and `setAttribute`.

### `setRelationship`

The `setRelationship` function establishes a referring relationship between two NFTs. It takes the following parameters:

```solidity
function setRelationship(uint256 _originalID, uint256 _derivativeID, uint256 _attribute) external;
```

- `_originalID`: the ID of the original NFT
- `_derivativeID`: the ID of the derivative NFT that refers to the original NFT
- `_attribute`: the quantifiable attribute for this relationship, which defaults to 1 if not specified

When called, this function establishes a referring relationship between the two NFTs.

### `setAttribute`

The `setAttribute` function sets a quantifiable attribute for an NFT. It takes the following parameters:

```solidity
function setAttribute(uint256 _id, string calldata _name, uint256 _value) external;
```

- `_id`: the ID of the NFT
- `_name`: the name of the attribute to be set
- `_value`: the value of the attribute to be set

When called, this function sets a quantifiable attribute for the NFT.

### Backward Compatibility

This EIP is designed to be fully backward-compatible with existing [ERC-721](./eip-721.md) and [ERC-1155](./eip-1155.md)  contracts and tokens. Existing NFT contracts and tokens will continue to function as they did before, and the new `setRelationship` and `setAttribute` functions will only be available to contracts that explicitly implement this EIP.

### Gas Considerations

To mitigate potential issues with excessive complexity and gas cost, the `setRelationship` function only allows for one referring relationship to be established between two NFTs, and the `setAttribute` function only allows for one attribute to be set at a time.

## Rationale

The [ERC-721](./eip-721.md) and [ERC-1155](./eip-1155.md) standard has been widely adopted for the creation of non-fungible tokens (NFTs) and has proven to be a versatile and flexible standard. However, there is currently no way to establish relationships between NFTs or to set quantifiable attributes for those relationships. This limits the potential use cases for NFTs, as it makes it difficult to track ownership history, establish provenance, and create interactive games and experiences.

The motivation behind proposing this EIP is to provide a way for NFT creators and users to establish relationships between NFTs and set quantifiable attributes for those relationships. This will enable more complex and interesting use cases for NFTs, such as tracking ownership history, establishing provenance, and creating interactive games and experiences.

In developing this EIP, some key design decisions were made. For example, we limited the complexity of the relationship graph that can be created by only allowing for one referring relationship between two NFTs. This helps to ensure that the graph remains manageable and does not become too complex to be useful. Additionally, we kept the gas cost of setting attributes to a minimum by only allowing for one attribute to be set at a time.

While there are currently no similar features in other blockchain languages or standards, we drew inspiration from the concept of Graph Theory, which is a branch of mathematics that studies the relationships between objects. By adding the ability to establish relationships between NFTs and set quantifiable attributes for those relationships, we believe that the extended NFT standard will become even more useful and versatile for NFT creators and users.

## Backwards Compatibility

No backward compatibility issues found.

## Test Cases

## Reference Implementation

```solidity
pragma solidity ^0.8.0;

contract NFTGraph {
    
    mapping(uint256 => mapping(uint256 => uint256)) public relationship;
    mapping(uint256 => mapping(bytes32 => bytes32)) public attributes;

    function setRelationship(uint256 originalNFT, uint256 derivativeNFT, uint256 relationshipValue) public {
        require(originalNFT != derivativeNFT, "Original and derivative NFTs must be different");
        relationship[originalNFT][derivativeNFT] = relationshipValue;
    }
    
    function setAttribute(uint256 nft, bytes32 attributeName, bytes32 attributeValue) public {
        attributes[nft][attributeName] = attributeValue;
    }
    
}
```

This example contract defines a NFTGraph contract that has a mapping called relationship that stores the relationships between original NFTs and derivative NFTs. The setRelationship function allows for the setting of the relationship value between two NFTs. The setAttribute function allows for the setting of attributes for NFTs using a mapping called attributes.

Note that this implementation is just an example, and it may not be suitable for production use without further testing and refinement.

## Security Considerations

Contracts that implement the `setRelationship` function should ensure that the relationship being established is valid and authorized by the appropriate parties. Additionally, contracts that implement the `setAttribute` function should ensure that the attributes being set are not malicious or otherwise harmful to the system.

## Copyright

Copyright and related rights waived via [CC0](../LICENSE.md).
